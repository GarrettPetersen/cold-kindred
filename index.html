<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <title>mystery.farm</title>
    <script>
      window.onerror = function(msg, url, line) {
        alert("ERROR: " + msg + "\nURL: " + url + "\nLine: " + line);
      };
    </script>
    <meta name="description" content="A daily genealogical murder mystery. Build a family tree using DNA evidence to find the killer among the animals." />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://mystery.farm/" />
    <meta property="og:title" content="mystery.farm" />
    <meta property="og:description" content="A daily genealogical murder mystery. Build a family tree using DNA evidence to find the killer." />
    <meta property="og:image" content="https://mystery.farm/social_sharing.png" />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="https://mystery.farm/" />
    <meta property="twitter:title" content="mystery.farm" />
    <meta property="twitter:description" content="A daily genealogical murder mystery. Build a family tree using DNA evidence to find the killer." />
    <meta property="twitter:image" content="https://mystery.farm/social_sharing.png" />

    <link rel="stylesheet" href="/src/style.css" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
  </head>
  <body>
    <canvas id="gameCanvas"></canvas>
    
    <!-- Intro Modal -->
    <div id="intro-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; color: white; z-index: 200; font-family: inherit; flex-direction: column; pointer-events: auto;">
      <!-- Scrollable Content -->
      <div id="intro-scroll-container" style="flex: 1; overflow-y: auto; overflow-x: hidden; padding: calc(40px + env(safe-area-inset-top)) 20px 20px 20px; display: flex; flex-direction: column; align-items: center; text-align: center; overscroll-behavior-x: none;">
        <div style="font-size: 18px; font-weight: bold; opacity: 0.3; margin-bottom: 20px; letter-spacing: 2px; pointer-events: none;">mystery.farm</div>
      <div id="intro-content" style="max-width: 800px; margin-top: auto; margin-bottom: auto;">
        <div id="intro-visual" style="margin-bottom: 20px; display: flex; justify-content: center;">
            <canvas id="introCanvas" width="600" height="300" style="image-rendering: pixelated; width: 600px; height: 300px; max-width: 100%; height: auto; background: #000; border: 2px solid rgba(255,255,255,0.1); border-radius: 0; box-shadow: inset 0 0 50px rgba(0,0,0,1), 0 4px 20px rgba(0,0,0,0.5);"></canvas>
        </div>
        <h2 id="intro-title" style="color: #ff4444; font-size: 28px; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 2px;"></h2>
        <div id="intro-text" style="font-size: 18px; line-height: 1.6; margin-bottom: 40px; min-height: 120px; color: #ccc; white-space: pre-line; overflow-wrap: break-word;"></div>
          
          <div id="character-selection" style="display: none;">
            <div class="char-card" data-char="fox">
              <canvas id="foxCanvas" width="128" height="128"></canvas>
              <div class="char-name">FILM NOIR FOX</div>
            </div>
            <div class="char-card" data-char="hare">
              <canvas id="hareCanvas" width="128" height="128"></canvas>
              <div class="char-name">SHERLOCK HARE</div>
            </div>
            <div class="char-card" data-char="boarot">
              <canvas id="boarotCanvas" width="128" height="128"></canvas>
              <div class="char-name">HERCULE BOAROT</div>
            </div>
            <div class="char-card" data-char="marmot">
              <canvas id="marmotCanvas" width="128" height="128"></canvas>
              <div class="char-name">MISS MARMOT</div>
            </div>
          </div>

        <div style="margin-top: 40px; padding-bottom: 20px; display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
            <a href="#" class="open-about-btn" style="color: white; text-decoration: underline; opacity: 0.6; font-size: 14px;">About</a>
            <a href="#" class="open-stats-btn" style="color: white; text-decoration: underline; opacity: 0.6; font-size: 14px;">Player Stats</a>
            <a href="#" class="open-privacy-btn" style="color: white; text-decoration: underline; opacity: 0.6; font-size: 14px;">Privacy Policy</a>
        </div>
        </div>
      </div>

      <!-- Scroll Hint Arrow -->
      <div id="intro-scroll-hint" style="display: none; position: absolute; bottom: 100px; left: 50%; transform: translateX(-50%); color: #44ff44; animation: bounce 2s infinite; pointer-events: auto; cursor: pointer; z-index: 15;">
        <div class="pixel-scroll-hint"></div>
      </div>

      <!-- Fixed Footer for Button -->
      <div id="intro-footer" style="padding: 20px; display: flex; justify-content: center; background: linear-gradient(to top, rgba(0,0,0,1) 70%, transparent); z-index: 20;">
        <button id="intro-next" class="pixel-button" style="background: white; color: black; padding: 12px 40px; font-weight: bold; font-size: 16px;">NEXT</button>
      </div>
    </div>

    <!-- Help Button -->
    <button id="help-btn">?</button>

    <!-- Speedrun Stopwatch -->
    <div id="stopwatch">00:00.0</div>

    <div id="ui-overlay">
      <div id="status-panel">
        <span class="dna-label">DNA TESTS:</span>
        <span class="dna-label-short" style="display: none;">DNA:</span>
        <span id="tests-count" style="color: #2d8a2d; font-weight: bold; display: flex; align-items: center; gap: 8px;">
          <div class="pixel-dna" style="margin-top: -2px;"></div> 3
        </span>
      </div>
      <div id="selection-panel" style="display: none;">
        <h2 id="selected-name"></h2>
        <p id="selected-species"></p>
        <div id="selection-hint">
          Click another animal to link them as parent & child.
        </div>
        <button id="dna-test-btn">DNA TEST</button>
        <button id="accuse-btn">ACCUSE</button>
      </div>
      <button id="play-again-ui" style="display: none;">PLAY AGAIN TOMORROW</button>
    </div>

    <!-- Smart Hint -->
    <div id="smart-hint">
      <div id="smart-hint-text"></div>
    </div>

    <!-- Transcript UI -->
    <div id="transcript-container">
      <div id="portrait-box">
        <canvas id="portraitCanvas" width="128" height="128" style="width: 100%; height: 100%;"></canvas>
      </div>
      <div id="transcript-header">
        <span id="transcript-toggle" style="display: flex; align-items: center; gap: 8px;">
          <div class="pixel-scroll-hint" style="transform: rotate(180deg); width: 16px; height: 10px; margin: 0;"></div>
          OPEN CASE LOG
        </span>
      </div>
      <div id="transcript-list">
        <!-- Log entries go here -->
      </div>
    </div>
    <!-- DNA Test Modal -->
    <div id="dna-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); color: white; z-index: 250; font-family: inherit; flex-direction: column; align-items: center; overflow-y: auto; pointer-events: auto; padding: 40px 0;">
      <div id="dna-modal-content" style="max-width: 600px; width: 90%; text-align: center; padding: 20px; margin: auto;">
        
        <!-- Confirmation Step -->
        <div id="dna-confirm-step" style="display: flex; flex-direction: column; align-items: center;">
          <h2 style="color: #44ff44; font-size: 24px; margin-bottom: 20px; letter-spacing: 2px;">DNA SEQUENCE REQUEST</h2>
          
          <!-- Animal Preview -->
          <div style="margin-bottom: 30px; display: flex; flex-direction: column; align-items: center;">
            <canvas id="dna-confirm-canvas" width="64" height="64" style="image-rendering: pixelated; width: 64px; height: 64px; background: rgba(0,0,0,0.3); border-radius: 0; margin-bottom: 10px;"></canvas>
            <div id="dna-confirm-name" style="font-weight: bold; font-size: 16px; padding: 4px 12px; background: rgba(0,0,0,0.6); border-radius: 0;"></div>
          </div>

          <p id="dna-confirm-text" style="font-size: 18px; line-height: 1.6; margin-bottom: 40px; color: #ccc;"></p>
          <div style="display: flex; gap: 20px;">
            <button id="dna-cancel-btn" class="pixel-button" style="background: rgba(255,255,255,0.1); color: white; padding: 12px 30px; font-weight: bold; font-size: 16px;">CANCEL</button>
            <button id="dna-confirm-btn" class="pixel-button" style="background: #44ff44; color: black; padding: 12px 40px; font-weight: bold; font-size: 16px;">CONFIRM</button>
          </div>
        </div>

        <!-- Animation Step -->
        <div id="dna-anim-step" style="display: none; width: 100%;">
          <h2 id="dna-modal-title" style="color: #44ff44; font-size: 24px; margin-bottom: 30px; letter-spacing: 2px;">ANALYZING DNA...</h2>
          
          <div style="position: relative; width: 100%; max-width: 350px; height: 200px; margin: 0 auto 30px auto; background: #000; border: 2px solid rgba(255,255,255,0.1); border-radius: 0; display: flex; align-items: center; justify-content: center; box-sizing: border-box;">
            <canvas id="dnaCanvas" width="350" height="200" style="image-rendering: pixelated; width: 100%; height: 100%; object-fit: contain;"></canvas>
          </div>

          <!-- Loading Bar (Pixel Art Style) -->
          <div style="width: 100%; max-width: 352px; height: 32px; background: #000; border: 4px solid #555; margin: 0 auto 40px auto; overflow: hidden; image-rendering: pixelated; position: relative; box-sizing: border-box;">
            <div id="dna-progress-bar" style="width: 0%; height: 100%; background: #44ff44; box-shadow: inset 0 4px 0 rgba(255,255,255,0.4), inset 0 -4px 0 rgba(0,0,0,0.3);"></div>
          </div>

          <div id="dna-result-box" style="display: none;">
            <p id="dna-result-text" style="font-size: 18px; line-height: 1.6; margin-bottom: 30px; color: #ccc;"></p>
            <button id="dna-done-btn" class="pixel-button" style="background: white; color: black; padding: 12px 40px; font-weight: bold; font-size: 16px;">CONTINUE</button>
          </div>
        </div>
      </div>
    </div>

    <div id="accuse-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); color: white; z-index: 260; font-family: inherit; flex-direction: column; align-items: center; overflow-y: auto; pointer-events: auto; padding: 40px 0;">
      <div style="max-width: 600px; width: 90%; text-align: center; padding: 20px; margin: auto;">
        <h2 style="color: #ff4444; font-size: 24px; margin-bottom: 20px; letter-spacing: 2px;">FINAL ACCUSATION</h2>
        
        <!-- Animal Preview -->
        <div style="margin-bottom: 30px; display: flex; flex-direction: column; align-items: center;">
          <canvas id="accuse-confirm-canvas" width="64" height="64" style="image-rendering: pixelated; width: 64px; height: 64px; background: rgba(0,0,0,0.3); border-radius: 0; margin-bottom: 10px;"></canvas>
          <div id="accuse-confirm-name" style="font-weight: bold; font-size: 16px; padding: 4px 12px; background: rgba(0,0,0,0.6); border-radius: 0;"></div>
        </div>

        <p id="accuse-confirm-text" style="font-size: 18px; line-height: 1.6; margin-bottom: 40px; color: #ccc;"></p>
        <div style="display: flex; gap: 20px; justify-content: center;">
          <button id="accuse-cancel-btn" class="pixel-button" style="background: rgba(255,255,255,0.1); color: white; padding: 12px 30px; font-weight: bold; font-size: 16px;">CANCEL</button>
          <button id="accuse-confirm-btn" class="pixel-button" style="background: #ff4444; color: black; padding: 12px 40px; font-weight: bold; font-size: 16px;">ACCUSE</button>
        </div>
      </div>
    </div>

    <div id="game-over" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; color: white; z-index: 300; font-family: inherit; flex-direction: column; pointer-events: auto;">
      <!-- Scrollable Content -->
      <div id="game-over-scroll-container" style="flex: 1; overflow-y: auto; overflow-x: hidden; padding: calc(40px + env(safe-area-inset-top)) 20px 20px 20px; display: flex; flex-direction: column; align-items: center; text-align: center; overscroll-behavior-x: none;">
        <div style="font-size: 18px; font-weight: bold; opacity: 0.3; margin-bottom: 20px; letter-spacing: 2px; pointer-events: none;">mystery.farm</div>
        <div id="game-over-content" style="max-width: 800px; margin-top: auto; margin-bottom: auto;">
        <div id="game-over-visual" style="margin-bottom: 20px; display: flex; justify-content: center;">
            <canvas id="gameOverCanvas" width="600" height="300" style="image-rendering: pixelated; width: 600px; height: 300px; max-width: 100%; height: auto; background: #000; border: 2px solid rgba(255,255,255,0.1); border-radius: 0; box-shadow: inset 0 0 50px rgba(0,0,0,1), 0 4px 20px rgba(0,0,0,0.5);"></canvas>
        </div>
        <h1 id="game-over-title" style="color: #44ff44; font-size: 32px; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 2px;"></h1>
        <div id="game-over-msg" style="font-size: 18px; line-height: 1.6; margin-bottom: 40px; min-height: 100px; color: #ccc; text-align: center; width: 100%;"></div>
        
        <div class="web-only" style="margin-bottom: 40px; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 0; border: 1px solid rgba(255,255,255,0.1); display: flex; flex-direction: column; align-items: center;">
          <p style="font-size: 14px; color: #44ff44; margin-bottom: 15px; font-weight: bold;">LOVE THE MYSTERY?</p>
          <a href="https://apps.apple.com/app/mystery-farm/id6757721736" target="_blank" class="app-store-badge">
            <img src="/assets/links/Download_on_the_App_Store_Badge_US-UK_RGB_wht_092917.svg" alt="Download on the App Store">
          </a>
          <p style="font-size: 12px; color: #ccc; margin-top: 10px; opacity: 0.8;">Get 3 mysteries per day on the App Store</p>
        </div>

        <div style="margin-top: 40px; padding-bottom: 20px; display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
            <a href="#" class="open-about-btn" style="color: white; text-decoration: underline; opacity: 0.6; font-size: 14px;">About</a>
            <a href="#" class="open-stats-btn" style="color: white; text-decoration: underline; opacity: 0.6; font-size: 14px;">Player Stats</a>
            <a href="#" class="open-privacy-btn" style="color: white; text-decoration: underline; opacity: 0.6; font-size: 14px;">Privacy Policy</a>
        </div>
        </div>
      </div>

      <!-- Scroll Hint Arrow -->
      <div id="game-over-scroll-hint" style="display: none; position: absolute; bottom: 100px; left: 50%; transform: translateX(-50%); color: #44ff44; animation: bounce 2s infinite; pointer-events: auto; cursor: pointer; z-index: 15;">
        <div class="pixel-scroll-hint"></div>
      </div>

      <!-- Fixed Footer for Buttons -->
      <div id="game-over-footer" style="padding: 20px; display: flex; justify-content: center; gap: 20px; background: linear-gradient(to top, rgba(0,0,0,1) 70%, transparent); z-index: 20;">
          <button id="game-over-next" class="pixel-button" style="background: white; color: black; padding: 12px 40px; font-weight: bold; font-size: 16px;">NEXT</button>
          <button id="game-over-view-farm" class="pixel-button" style="display: none; background: rgba(255,255,255,0.1); color: white; padding: 12px 40px; font-weight: bold; font-size: 16px;">VIEW THE FARM</button>
          <button id="game-over-solve-another" class="pixel-button" style="display: none; background: #44ff44; color: black; padding: 12px 40px; font-weight: bold; font-size: 16px;">SOLVE ANOTHER CASE</button>
      </div>
    </div>
    <div id="stats-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); color: white; z-index: 1000; font-family: inherit; flex-direction: column; align-items: center; overflow-y: auto; pointer-events: auto; padding: 40px 0;">
      <div style="max-width: 600px; width: 90%; text-align: center; padding: 20px; margin: auto;">
        <h2 style="color: #44ff44; font-size: 24px; margin-bottom: 30px; letter-spacing: 2px;">SERVICE RECORD</h2>
        
        <div style="display: flex; flex-direction: column; align-items: center; margin-bottom: 30px; background: rgba(255,255,255,0.05); padding: 30px; border-radius: 0; border: 1px solid rgba(255,255,255,0.1); position: relative; min-width: 300px; min-height: 200px; justify-content: center;">
          <div id="stats-cheat-zone" style="position: absolute; top: 0; left: 0; width: 40px; height: 40px; cursor: pointer; z-index: 10;"></div>
          <input type="text" id="stats-cheat-input" style="display: none; position: absolute; top: 10px; width: 150px; background: #222; color: #44ff44; border: 1px solid #44ff44; font-family: inherit; text-align: center; z-index: 20;" placeholder="CODE?">
          <canvas id="statsProgressCanvas" width="150" height="150" style="position: absolute; top: 15px; left: 15px; width: 150px; height: 150px; image-rendering: pixelated; pointer-events: none;"></canvas>
          <div style="position: relative; margin-bottom: 20px;">
            <canvas id="statsBadgeCanvas" width="128" height="128" style="width: 128px; height: 128px; image-rendering: pixelated;"></canvas>
            <div id="stats-rank-badge-label" class="pixel-button" style="position: absolute; bottom: -10px; left: 50%; transform: translateX(-50%); background: #44ff44; color: black; font-weight: bold; padding: 2px 10px; font-size: 14px; white-space: nowrap;">ROOKIE</div>
          </div>
          <div id="stats-wins-count" style="font-size: 32px; font-weight: bold; margin-bottom: 5px;">0</div>
          <div style="font-size: 14px; opacity: 0.6; letter-spacing: 1px;">CASES SOLVED</div>
        </div>

        <button id="close-stats-btn" class="pixel-button" style="background: white; color: black; padding: 12px 40px; font-weight: bold; font-size: 16px;">BACK</button>
      </div>
    </div>

    <div id="limit-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); color: white; z-index: 500; font-family: inherit; flex-direction: column; align-items: center; overflow-y: auto; pointer-events: auto; padding: 40px 0;">
      <div style="max-width: 500px; width: 90%; text-align: center; padding: 40px; background: #111; border: 1px solid #333; border-radius: 0; box-shadow: 0 10px 50px rgba(0,0,0,0.8); margin: auto;">
        <div class="pixel-hourglass" style="margin-bottom: 30px;"></div>
        <h2 style="color: #44ff44; font-size: 24px; margin-bottom: 20px; letter-spacing: 2px;">TODAY'S CASE IS SOLVED</h2>
        <p style="font-size: 18px; line-height: 1.6; color: #ccc; margin-bottom: 30px;">
          The local authorities are processing the evidence.
          <br><br>
          A new mystery will be assigned at <b>midnight</b>. See you then, detective!
        </p>
        <button id="close-limit-btn" class="pixel-button" style="background: white; color: black; padding: 12px 40px; font-weight: bold; font-size: 16px;">UNDERSTOOD</button>

        <div class="web-only" style="margin-top: 40px; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 0; border: 1px solid rgba(255,255,255,0.1);">
          <p style="font-size: 14px; color: #44ff44; margin-bottom: 15px; font-weight: bold;">WANT MORE MYSTERIES?</p>
          <p style="font-size: 14px; color: #ccc; margin-bottom: 20px;">The App Store version offers <b>3 mysteries per day</b> and helps support the game!</p>
          <a href="https://apps.apple.com/app/mystery-farm/id6757721736" target="_blank" class="app-store-badge">
            <img src="/assets/links/Download_on_the_App_Store_Badge_US-UK_RGB_wht_092917.svg" alt="Download on the App Store">
          </a>
        </div>

        <div style="margin-top: 40px; display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
          <a href="#" class="open-about-btn" style="color: white; text-decoration: underline; opacity: 0.6; font-size: 14px;">About</a>
          <a href="#" class="open-stats-btn" style="color: white; text-decoration: underline; opacity: 0.6; font-size: 14px;">Player Stats</a>
          <a href="#" class="open-privacy-btn" style="color: white; text-decoration: underline; opacity: 0.6; font-size: 14px;">Privacy Policy</a>
        </div>
      </div>
    </div>

    <!-- Transition Modal -->
    <div id="transition-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; color: white; z-index: 400; font-family: inherit; flex-direction: column; align-items: center; overflow-y: auto; pointer-events: auto; padding: 40px 0;">
      <div style="max-width: 600px; width: 90%; text-align: center; padding: 20px; margin: auto;">
        <div style="margin-bottom: 30px;">
          <canvas id="transitionCanvas" width="128" height="128" style="image-rendering: pixelated; width: 128px; height: 128px;"></canvas>
        </div>
        <div id="transition-text" style="font-size: 20px; line-height: 1.6; min-height: 80px; color: #ccc; font-weight: bold; margin-bottom: 40px;"></div>
        <button id="transition-start-btn" class="pixel-button" style="background: #44ff44; color: black; padding: 12px 40px; font-weight: bold; font-size: 16px;">BEGIN INVESTIGATION</button>
      </div>
    </div>

    <!-- How to Play Modal -->
    <div id="how-to-play-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); color: #2c3e50; z-index: 600; font-family: inherit; flex-direction: column; align-items: center; overflow-y: auto; pointer-events: auto; padding: 40px 0;">
      <div style="background-color: #fff9e6; max-width: 500px; width: 90%; padding: 40px 30px 30px 60px; position: relative; border-radius: 0; box-shadow: 0 10px 50px rgba(0,0,0,0.8); background-image: linear-gradient(90deg, transparent 49px, #ff9999 50px, #ff9999 51px, transparent 52px), linear-gradient(#d1e5f0 1px, transparent 1px); background-size: 100% 1.5rem; line-height: 1.5rem; background-attachment: local; box-sizing: border-box; margin: auto;">
        <h2 style="color: #5d3a1a; margin-top: 0; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 1px; border-bottom: 2px solid #5d3a1a; display: inline-block;">HOW TO PLAY</h2>
        
        <!-- Visual Guide -->
        <div style="position: relative; width: 100%; height: 280px; margin-bottom: 20px; background: rgba(0,0,0,0.03); border-radius: 0; border: 1px dashed rgba(0,0,0,0.1); display: flex; align-items: center; justify-content: center; overflow: hidden;">
          <div style="position: relative; width: 240px; height: 240px;">
            <canvas id="tutorialCanvas" width="240" height="240" style="image-rendering: pixelated; width: 240px; height: 240px;"></canvas>

            <!-- DNA Result Label -->
            <div style="position: absolute; top: 5px; left: 10px; font-size: 11px; color: #2d8a2d; font-weight: bold; width: 90px; line-height: 1.1; pointer-events: none; text-align: left;">
              DNA RESULT
              <span style="display: block; margin-top: 5px; margin-left: 45px;"><div class="pixel-arrow-dr"></div></span>
            </div>

            <!-- Speech Bubble Label -->
            <div style="position: absolute; top: 40px; right: 5px; font-size: 11px; color: #5d3a1a; font-weight: bold; width: 80px; line-height: 1.1; pointer-events: none; text-align: right;">
              CLUE
              <span style="display: block; margin-top: 5px; margin-right: 30px;"><div class="pixel-arrow-dl"></div></span>
            </div>

            <!-- Name Label -->
            <div style="position: absolute; bottom: 10px; left: 65px; font-size: 11px; color: #5d3a1a; font-weight: bold; width: 50px; line-height: 1.1; pointer-events: none; text-align: center;">
              <div class="pixel-arrow-up"></div><br>NAME
            </div>

            <!-- Age Label -->
            <div style="position: absolute; bottom: 10px; right: 65px; font-size: 11px; color: #5d3a1a; font-weight: bold; width: 50px; line-height: 1.1; pointer-events: none; text-align: center;">
              <div class="pixel-arrow-up"></div><br>AGE
            </div>
          </div>
        </div>

        <p style="margin-bottom: 20px;"><strong>Objective:</strong> Identify the killer among the animals on the farm.</p>

        <p style="margin-bottom: 15px;"><strong>1. Collect Clues:</strong> Click on the <strong>speech bubbles</strong> above animals. They will tell you about their relatives or things they saw.</p>
        
        <p style="margin-bottom: 15px;"><strong>2. Build the Tree:</strong> Click an animal, then click another to link them as Parent/Child. The older animal is automatically set as the parent. (HINT: Parents are always 20-39 years older than their kids.) Use the clues to reconstruct the genealogy.</p>

        <p style="margin-bottom: 15px;"><strong>3. DNA Testing:</strong> You have 3 DNA tests. Testing an animal reveals their exact relationship to the killer (e.g., "The Killer's Cousin"). <strong>Testing the killer is an automatic win!</strong></p>

        <p style="margin-bottom: 15px;"><strong>4. Accuse:</strong> Once you are certain, select the killer and click <strong>ACCUSE</strong>. You must have used all DNA tests to make an accusation.</p>

        <p style="margin-bottom: 20px; font-weight: bold; opacity: 0.8;">A new mystery is generated every day at midnight.</p>

        <div style="text-align: center; margin-top: 30px;">
          <button id="close-how-btn" class="pixel-button" style="background: #5d3a1a; color: #fff9e6; padding: 10px 30px; font-weight: bold; font-family: inherit; font-size: 16px;">GOT IT</button>
        </div>

        <div style="margin-top: 30px; padding-top: 20px; border-top: 1px dashed rgba(93, 58, 26, 0.2); display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
          <a href="#" class="open-about-btn" style="color: #5d3a1a; text-decoration: underline; opacity: 0.7; font-size: 14px;">About</a>
          <a href="#" class="open-stats-btn" style="color: #5d3a1a; text-decoration: underline; opacity: 0.7; font-size: 14px;">Player Stats</a>
          <a href="#" class="open-privacy-btn" style="color: #5d3a1a; text-decoration: underline; opacity: 0.7; font-size: 14px;">Privacy Policy</a>
        </div>
      </div>
    </div>

    <!-- About Modal -->
    <div id="about-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); color: #2c3e50; z-index: 1100; font-family: inherit; flex-direction: column; align-items: center; overflow-y: auto; pointer-events: auto; padding: 40px 0;">
      <div style="background-color: #fff9e6; max-width: 600px; width: 90%; padding: 40px 30px 30px 60px; position: relative; border-radius: 0; box-shadow: 0 10px 50px rgba(0,0,0,0.8); background-image: linear-gradient(90deg, transparent 49px, #ff9999 50px, #ff9999 51px, transparent 52px), linear-gradient(#d1e5f0 1px, transparent 1px); background-size: 100% 1.75rem; line-height: 1.75rem; background-attachment: local; box-sizing: border-box; margin: auto;">
        <h2 style="color: #5d3a1a; margin-top: 0; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 1px; border-bottom: 2px solid #5d3a1a; display: inline-block;">ABOUT THE GAME</h2>
        
        <p>Welcome to <strong>mystery.farm</strong>, a daily genealogical murder mystery.</p>

        <h3 style="font-size: 18px; color: #5d3a1a; margin-top: 30px;">THE CONCEPT</h3>
        <p>Every day at midnight, a new crime is committed on the farm. As the lead detective, your job is to reconstruct the family tree of the residents using DNA evidence and witness testimonies to identify the killer.</p>

        <h3 style="font-size: 18px; color: #5d3a1a; margin-top: 30px;">INSPIRATION</h3>
        <p>This game was inspired by the real-life investigation of the Golden State Killer. Investigators found two 3rd cousins of the killer, and then traced their geneaology to a shared ancestor. Then they worked their way down the family tree from that ancestor to find the one person who could have committed the murders.</p>

        <p>The first draft of the game was a realistic murder mystery, but we later simplified it into this puzzle format using cute pixel art animals. "Why not?" we thought, and made it a cute animal murder mystery.</p>

        <h3 style="font-size: 18px; color: #5d3a1a; margin-top: 30px;">THE CREATOR</h3>
        <p>I am a solo developer who loves puzzle games. My first game was <a href="https://connecdoku.com" style="color: #5d3a1a; text-decoration: underline;">Connecdoku</a>, a word game with elements of NYT Connections and Sudoku.</p>

        <p>You can find me on X at <a href="https://x.com/garrettpetersen" style="color: #5d3a1a; text-decoration: underline;">@GarrettPetersen</a>.</p>

        <div class="web-only" style="margin-top: 30px; padding: 20px; background: rgba(0,0,0,0.03); border-radius: 0; border: 1px dashed rgba(0,0,0,0.1); text-align: center;">
          <p style="font-size: 14px; color: #5d3a1a; margin-bottom: 15px; font-weight: bold;">PLAY ON MOBILE</p>
          <a href="https://apps.apple.com/app/mystery-farm/id6757721736" target="_blank" class="app-store-badge">
            <img src="/assets/links/Download_on_the_App_Store_Badge_US-UK_RGB_wht_092917.svg" alt="Download on the App Store">
          </a>
          <p style="font-size: 12px; color: #5d3a1a; margin-top: 10px; opacity: 0.8;">3 mysteries per day â€¢ Native performance</p>
        </div>

        <div style="text-align: center; margin-top: 30px;">
          <button id="close-about-btn" class="pixel-button" style="background: #5d3a1a; color: #fff9e6; padding: 10px 30px; font-weight: bold; font-family: inherit; font-size: 16px;">BACK</button>
        </div>
      </div>
    </div>

    <!-- Privacy Modal -->
    <div id="privacy-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); color: #2c3e50; z-index: 1100; font-family: inherit; flex-direction: column; align-items: center; overflow-y: auto; pointer-events: auto; padding: 40px 0;">
      <div style="background-color: #fff9e6; max-width: 600px; width: 90%; padding: 40px 30px 30px 60px; position: relative; border-radius: 0; box-shadow: 0 10px 50px rgba(0,0,0,0.8); background-image: linear-gradient(90deg, transparent 49px, #ff9999 50px, #ff9999 51px, transparent 52px), linear-gradient(#d1e5f0 1px, transparent 1px); background-size: 100% 1.75rem; line-height: 1.75rem; background-attachment: local; box-sizing: border-box; margin: auto;">
        <h2 style="color: #5d3a1a; margin-top: 0; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 1px; border-bottom: 2px solid #5d3a1a; display: inline-block;">PRIVACY POLICY</h2>
        
        <p>Last Updated: January 5, 2026</p>

        <h3 style="font-size: 18px; color: #5d3a1a; margin-top: 30px;">1. Data Collection</h3>
        <p>We do <strong>not</strong> collect any personal information. The game does not require an account or any identifying information to play.</p>

        <h3 style="font-size: 18px; color: #5d3a1a; margin-top: 30px;">2. Local Storage</h3>
        <p>The game uses your device's <strong>Local Storage</strong> to save your progress and statistics. This data stays on your device and is never sent to our servers.</p>

        <h3 style="font-size: 18px; color: #5d3a1a; margin-top: 30px;">3. Third-Party Services</h3>
        <p>The game does not use any third-party tracking, analytics, or advertising services.</p>

        <h3 style="font-size: 18px; color: #5d3a1a; margin-top: 30px;">4. Children's Privacy</h3>
        <p>Because we do not collect any personal information, the game is safe for players of all ages.</p>

        <div style="text-align: center; margin-top: 30px;">
          <button id="close-privacy-btn" class="pixel-button" style="background: #5d3a1a; color: #fff9e6; padding: 10px 30px; font-weight: bold; font-family: inherit; font-size: 16px;">BACK</button>
        </div>
      </div>
    </div>

    <script type="module" src="/src/main.js"></script>
  </body>
</html>
